<% if user_signed_in? && current_user.admin? %>
  <div class="container my-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="display-5">Users</h1>
    </div>

    <table class="table table-striped table-hover shadow-sm">
      <thead class="table-dark">
        <tr>
          <th>User ID</th>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Email</th>
          <th>Messages Sent</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% sorted_users = [current_user] + (@users - [current_user]) %>

        <% sorted_users.each do |user| %>
          <tr>
            <td><%= user.id %></td>
            <td><%= user.first_name %></td>
            <td><%= user.last_name %></td>
            <td><%= user.email %></td>
            <td><%= user.messages.count %></td>
            <td>
              <%= link_to 'Open', user_path(user), class: 'btn btn-primary btn-sm' %>
              <%= link_to 'Edit', edit_user_registration_path, class: 'btn btn-outline-secondary btn-sm ms-1' if user == current_user %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>
